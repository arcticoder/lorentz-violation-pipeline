# Lorentz-Violation Pipeline

End-to-end toolkit for setting bounds on Planck-scale Lorentz invariance violation using:

- **GRB dispersion** (Fermi-LAT time-tagged events)
- **UHECR spectrum analysis** (Pierre Auger Observatory data)

## Setup

```bash
git clone https://github.com/arcticoder/lorentz-violation-pipeline
cd lorentz-violation-pipeline
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## Data Structure

The pipeline expects the following data structure:

```cpp
data/
  dataSummarySD1500.csv    # Pierre Auger SD1500 events
  dataSummarySD750.csv     # Pierre Auger SD750 events  
  dataSummaryInclined.csv  # Pierre Auger inclined events
  grbs/
    GRB090510.csv          # GRB time-tagged events (if available)
    GRB221009A.csv
  uhecr/                   # Generated by analysis scripts
    sd1500_spectrum.csv    # Derived energy spectrum
    uhecr_exclusion.csv    # LIV bounds
```

## Usage

### 1. UHECR Spectrum Analysis

Build energy spectrum from Pierre Auger data using `sd_s38` as energy estimator:

```bash
python scripts/uhecr_spectrum.py
```

This script:
- Loads Pierre Auger Observatory cosmic ray data
- Applies updated energy calibration: E = 4.17×10¹⁶ × (sd_s38)¹·⁰⁷ eV
- Bins events in energy and calculates flux J(E) = N/(exposure × ΔE)
- Generates spectrum plots with Poisson error bars
- Includes systematic uncertainty analysis

### 2. LIV Threshold Analysis

Estimate Lorentz violation bounds from flux suppression:

```bash
python scripts/uhecr_liv_analysis.py
```

This script:
- Identifies flux suppression at highest energies
- Calculates LIV energy scales for different orders (n=1,2)
- Saves exclusion bounds compatible with combined analysis

### 3. GRB Analysis (if data available)

```bash
python scripts/analyze_grb.py
```

### 4. Combined Figure of Merit

```bash
python scripts/combined_fom.py
```

Combines all available bounds (GRB + UHECR) and reports the most stringent limit.

### 5. Complete Analysis Summary

```bash
python scripts/analysis_summary.py
```

Generates comprehensive summary with all results, methodology, and visualizations.

## Output

The analysis generates:

- **Energy spectra**: CSV files and plots showing cosmic ray flux vs energy
- **LIV bounds**: Exclusion limits on Lorentz violation energy scales  
- **Summary plots**: Comparative visualizations of bounds vs theoretical scales
- **Combined FOM**: Overall figure of merit from all analysis methods

## Methodology

### Energy Calibration
Uses Pierre Auger Observatory calibration relating signal size to primary energy:
```
E_primary = A × (sd_s38)^B
```
where A = 4.17×10¹⁶ eV and B = 1.07 (latest published calibration).

This gives: E [EeV] = 0.0417 × (sd_s38)^1.07

Systematic uncertainties: ~14% (dominated by fluorescence yield and atmospheric modeling).

### LIV Bounds
Flux suppression at energy E_cutoff translates to LIV bounds via:
- Linear LIV (n=1): E_LIV ≈ E_cutoff
- Quadratic LIV (n=2): E_LIV ≈ √(E_cutoff × M_Planck)

Results are compared to theoretical scales (Planck scale ≈ 1.22×10¹⁰ GeV).

```